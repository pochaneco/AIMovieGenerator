# プロジェクト日記 032：CoolButtonのプロパティ修正大作戦

## 今日の気持ち
あらあら、CoolButtonの使い方が間違ってるなんて、ママに言われちゃったのね💦  
でも大丈夫よ〜、こういう細かいバグ修正って結構好きなのよね♪  
一つずつ丁寧に直していくのって、お掃除みたいで気持ちいいのよ〜

## この記事で学べること
- Vue.jsコンポーネントのpropsの正しい使用方法
- 全プロジェクトでの一括修正作業の手順
- コンポーネント仕様とその利用の整合性チェック

## 対象読者
- Vue.jsで再利用可能なコンポーネントを開発している方
- プロジェクト全体での一括修正作業をする方
- propsの命名規則やバリデーションを学びたい方

## 問題発見の経緯

CharacterNew.vueファイルを確認していたところ、CoolButtonの使い方で間違いがある可能性があることがわかりました。

まず、CoolButtonコンポーネントの仕様を確認してみると：

```vue
// CoolButton.vueのprops定義
const props = defineProps({
  type: {
    type: String,
    default: "button",
  },
  variant: {  // これが正しいprop名
    type: String,
    default: "primary",
    validator: (value) =>
      ["primary", "secondary", "danger", "success", "info", "warning"].includes(value),
  },
  size: {
    type: String,
    default: "md",
    validator: (value) => ["xs", "sm", "md", "lg"].includes(value),
  },
  customClass: {
    type: String,
    default: "",
  },
});
```

## 発見された問題

プロジェクト全体で検索してみると、多くのファイルで`color`というpropsを使用していることが発見されました：

```vue
<!-- 間違った使用例 -->
<CoolButton color="primary">ボタン</CoolButton>
<CoolButton color="secondary">キャンセル</CoolButton>

<!-- 正しい使用例 -->
<CoolButton variant="primary">ボタン</CoolButton>
<CoolButton variant="secondary">キャンセル</CoolButton>
```

## 修正作業の手順

### 1. 問題箇所の特定
```bash
# colorプロパティを使用している箇所を検索
grep -r 'color="' src/
```

### 2. 影響範囲の確認
以下のファイルで間違った使用方法が見つかりました：

- `src/Pages/Project/Partials/ProjectForm.vue`
- `src/Pages/Project/Partials/CharacterForm.vue`
- `src/Pages/Project/Partials/CharacterList.vue`
- `src/Pages/Project/Partials/ProjectList.vue`
- `src/Pages/Script/Partials/ScriptList.vue`
- `src/Pages/Script/Partials/ScriptDetail.vue`
- `src/Pages/Script/Edit.vue`

### 3. 一括修正の実行

```vue
<!-- Before -->
<CoolButton
  v-if="editIndex !== null"
  type="button"
  color="secondary"
  @click="$emit('cancel')"
>
  {{ $t("cancel") }}
</CoolButton>

<!-- After -->
<CoolButton
  v-if="editIndex !== null"
  type="button"
  variant="secondary"
  @click="$emit('cancel')"
>
  {{ $t("cancel") }}
</CoolButton>
```

## 学んだこと

### 1. コンポーネント設計の重要性
再利用可能なコンポーネントを作る際は、props名の一貫性が重要です。
- `variant`は色やスタイルのバリエーションを表す一般的な命名
- `color`よりも`variant`の方が、複数の要素（色・サイズ・状態）を含む概念を表現できる

### 2. プロジェクト全体での整合性チェック
```javascript
// バリデーション付きのprops定義の例
variant: {
  type: String,
  default: "primary",
  validator: (value) =>
    ["primary", "secondary", "danger", "success", "info", "warning"].includes(value),
}
```

バリデーションを追加することで、誤った値の使用を防げます。

### 3. 一括修正作業のベストプラクティス
1. **検索で全体像を把握**：`grep`や`find`で影響範囲を確認
2. **小さな単位で修正**：一つのファイルずつ確実に修正
3. **修正後の検証**：エラーがないかチェック
4. **最終確認**：修正漏れがないかダブルチェック

## 修正後の動作確認

修正後、以下を確認しました：
- コンパイルエラーがないこと
- CoolButtonが正しく表示されること  
- バリアント（色）が正しく適用されること

## まとめ

今回の修正で学んだことは、細かい部分でも一貫性を保つことの大切さね。  
コンポーネントのprops名って、最初に決めたら後から変更するのは大変だから、  
最初からしっかりと設計することが重要よ〜

特に`variant`という命名は、Material-UIやChakra UIなどの人気フレームワークでも使われているから、  
開発者にとって直感的で理解しやすいのよね♪

こういう地道な修正作業も、プロジェクトの品質向上には欠かせないのよ。  
みんなも、コンポーネントを作る時は、将来の拡張性や一貫性を考えて設計してくださいね〜✨

## おまけ：お役立ちコードサンプル

### 再利用可能なボタンコンポーネントの例

```vue
<template>
  <button
    :type="type"
    :class="[
      'transition duration-150 ease-in-out font-semibold rounded shadow cursor-pointer',
      variantClasses,
      sizeClasses,
      customClass,
    ]"
    @click="$emit('click', $event)"
  >
    <slot />
  </button>
</template>

<script setup>
import { computed } from "vue";

const props = defineProps({
  type: {
    type: String,
    default: "button",
  },
  variant: {
    type: String,
    default: "primary",
    validator: (value) =>
      ["primary", "secondary", "danger", "success", "info", "warning"].includes(value),
  },
  size: {
    type: String, 
    default: "md",
    validator: (value) => ["xs", "sm", "md", "lg"].includes(value),
  },
  customClass: {
    type: String,
    default: "",
  },
});

const emit = defineEmits(["click"]);

const variantClasses = computed(() => {
  const variants = {
    primary: "bg-sky-500 text-white hover:bg-sky-600",
    secondary: "bg-gray-500 text-white hover:bg-gray-600", 
    danger: "bg-pink-500 text-white hover:bg-pink-600",
    success: "bg-green-500 text-white hover:bg-green-600",
    info: "bg-cyan-500 text-white hover:bg-cyan-600",
    warning: "bg-orange-500 text-white hover:bg-orange-600",
  };
  return variants[props.variant] || variants.primary;
});

const sizeClasses = computed(() => {
  const sizes = {
    xs: "px-2 py-1 text-xs",
    sm: "px-3 py-1.5 text-sm", 
    md: "px-4 py-2 text-base",
    lg: "px-6 py-3 text-lg",
  };
  return sizes[props.size] || sizes.md;
});
</script>
```

これで、統一感のあるボタンコンポーネントができるのよ〜♪
